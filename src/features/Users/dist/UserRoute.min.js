"use strict";var express=require("express"),JWT=require("jsonwebtoken"),argon2=require("argon2"),UserModel=require("../Models/UserModel"),router=express.Router();router.post("/signup",function(r,s){var t,n,a,u,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.body,n=t.name,a=t.email,u=t.password,e.next=3,regeneratorRuntime.awrap(argon2.hash(u));case 3:return o=e.sent,e.next=6,regeneratorRuntime.awrap(UserModel.findOne({email:a}));case 6:if(i=e.sent,e.prev=7,i)return e.abrupt("return",s.status(400).send({message:"User already exist, Please enter different email"}));e.next=10;break;case 10:return e.next=12,regeneratorRuntime.awrap(UserModel.create({name:n,email:a,password:o}));case 12:return e.sent.save(),e.abrupt("return",s.status(201).send({message:"User created successfully"}));case 17:return e.prev=17,e.t0=e.catch(7),e.abrupt("return",s.status(404).send({message:e.t0.message}));case 20:case"end":return e.stop()}},null,null,[[7,17]])});var REFRESHKEY="REFRESH12",SECRETKEY="MOCK12";router.post("/login",function(r,s){var t,n,a,u,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.body,n=t.email,a=t.password,e.next=3,regeneratorRuntime.awrap(UserModel.findOne({email:n}));case 3:if(u=e.sent)return e.next=7,regeneratorRuntime.awrap(argon2.verify(u.password,a));e.next=11;break;case 7:if(e.sent)return o=JWT.sign({id:u._id,name:u.name},SECRETKEY,{expiresIn:"7 days"}),i=JWT.sign({id:u._id,name:u.name},REFRESHKEY,{expiresIn:"28 days"}),e.abrupt("return",s.status(200).send({message:"Login successfully",token:o,refreshToken:i,email:u.email}));e.next=11;break;case 11:return e.abrupt("return",s.status(401).send("Invalid Credentials or User is not Registerd"));case 12:case"end":return e.stop()}})}),router.post("/logout",function(e,r){e.headers.authorization;try{return r.status(200).send({message:"Logout Successfull"})}catch(e){return r.status(404).send({message:e.message})}}),module.exports=router;
//# sourceMappingURL=UserRoute.min.js.map
